<!doctype html>
<html>
	<head>
		<title>Socket.IO chat</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			body {
				font: 13px Helvetica, Arial;
			}
			form {
				background: #000;
				padding: 3px;
				position: fixed;
				bottom: 0;
				width: 100%;
			}
				form input {
					border: 0;
					padding: 10px;
					width: 90%;
					margin-right: .5%;
				}
				form button {
					width: 9%;
					background: rgb(130, 224, 255);
					border: none;
					padding: 10px;
				}
			#messages {
				list-style-type: none;
				margin: 0;
				padding: 0;
			}
				#messages li {
					padding: 5px 10px;
				}
					#messages li:nth-child(odd) {
						background: #eee;
					}
		</style>
	</head>
	<body>
		<ul id="messages"></ul>
		<form action="">
			<input type="text" autocomplete="off" id="m"/><button>Send</button>
		</form>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			var socket = io();

			var form = document.querySelector('form');

			if (form !== null) {
				var input = document.getElementById('m');
				form.addEventListener('submit', event => {
					event.preventDefault();

					socket.emit('chat message', input.value);
					
					input.value = '';
					
					return false;
				});
			}

			var list = document.getElementById('messages');

			if (list !== null) {
				socket.on('chat message', msg => {
					var li = document.createElement('LI');
					li.innerText = msg;
					list.appendChild(li);
				});
				socket.on('user_conected', event => {
					var small = document.createElement('small');
					small.innerText = 'New user connected';

					var li = document.createElement('li');
					li.appendChild(small);
					list.appendChild(li);
				});
				socket.on('user_disconnected', event => {
					var small = document.createElement('small');
					small.innerText = "A user left :'(";

					var li = document.createElement('li');
					li.appendChild(small);
					list.appendChild(li);
				});
			}
		</script>
	</body>
</html>